<html>

<head>
    <title>import</title>
    <link rel="stylesheet" href="../manual_style.css" type="text/css" />
</head>

<body>
<div class="content">

<!-- HEADER (use only on bookchapters) -->
<table summary="" class="header">
	<tr>
		<td align="left" class="helphead_l"><a href="../toc.html"><div class="helplink">&nbsp;</div></a></td>
		<td align="right" class="helphead_r"></td>
	</tr>
</table>

<!-- CONTENT -->

<h1>import</h1>

<h2>Syntax</h2>

<ol>
	<li><p class="code2">import <span class="cga_opparam">id</span> : <span class="cga_opparam">filePath</span></p></li>
	<li><p class="code2">import <span class="cga_opparam">id</span> ( <span class="cga_opparam">styleId</span>, ... , <span class="cga_opparam">styleId</span> ) : <span class="cga_opparam">filePath</span></p></li>
	<li><p class="code2">import <span class="cga_opparam">id</span> : <span class="cga_opparam">filePath</span> ( <span class="cga_opparam">attrId</span>, ... , <span class="cga_opparam">attrId</span> )</p></li>
	<li><p class="code2">import <span class="cga_opparam">id</span> : <span class="cga_opparam">filePath</span> ( <span class="cga_opparam">attrId</span> = <span class="cga_opparam">expression</span>, ... , <span class="cga_opparam">attrId</span> = <span class="cga_opparam">expression</span> )</p></li>
	<li><p class="code2">import <span class="cga_opparam">id</span> : <span class="cga_opparam">filePath</span> ( )</p></li>
	<li><p class="code2">import <span class="cga_opparam">id</span> : <span class="cga_opparam">filePath</span> ( <span class="cga_opparam">extensionId</span> --> <span class="cga_opparam">operations</span>, ... , <span class="cga_opparam">extensionId</span> --> <span class="cga_opparam">operations</span> )</p></li>
</ol>

<h2>Parameters</h2>
<ul>
	<li><span class="cga_opparam">id</span><br/>Unique prefix for the imported rules, attributes and functions.</li>
	<li><span class="cga_opparam">filePath</span> (string)<br/>Absolute or relative path to a CGA rule file (e.g. <span class="codelight">"file.cga"</span>). See <a class="normw" href="cga_assetSearch.html">Asset Search</a> for details about the supported syntax.</li>
</ul>

<h2>Description</h2>

<p>Rules, attributes and functions from an existing rule file can be imported by a rule file by the <span class="codelight">import</span> keyword (syntax 1). Importing a rule file makes all rules, attributes and functions of the <i>imported</i> rule file available prefixed by <span class="cga_opparam">id</span>. If the <i>imported</i> rule file contains multiple styles, by default all styles are imported and visible in the style manager.</p>
		
<p>In order to limit the styles available in an <i>importing</i> rule file, the set of imported styles can be specified by enumerating the imported styles in parenthesis after the import <span class="cga_opparam">id</span> (syntax 2).</p>

<p>By default, attribute values from an <i>importing</i> rule file (e.g. <span class="codelight">height</span> in <span class="codelight">main.cga</span> <a href="import.html#attrPropagation">below</a>) are propagated to the <i>imported</i> rule file (e.g. <span class="codelight">height</span> in <span class="codelight">structure.cga</span> takes its value from <span class="codelight">height</span> in <span class="codelight">main.cga</span> <a href="import.html#attrPropagation">below</a>). In order to disable this default behavior (e.g. because an attribute in an <i>imported</i> rule file has the same name but a different semantic and should therefore not be overwritten), the attributes in an <i>imported</i> rule file can be protected by enumerating them after the rule file (syntax 3).</p>
		
<p>Attributes can not only be protected but an <i>importing</i> rule file can additionally specify a new value for the attribute by redefining the attribute with an expression (syntax 4) where the right hand side <span class="cga_opparam">expression</span> is evaluated in the scope of the <i>importing</i> rule file.</p>

<p>Using empty parentheses (syntax 5) protects all imported attributes. Setting the attribute source of an imported attribute in the inspector to something else than "Rule-defined value" will disable this behavior for that attribute completely and the value will be taken from the designated source instead.</p>

<p>Similarly to attributes, rules can be redefined with a sequence of operations (syntax 6) where the right hand side <span class="cga_opparam">operations</span> is evaluated in the scope of the <i>importing</i> rule file. The redefined rule in the <i>imported</i> rule file must be an <a href="extension.html">extension rule</a>. Within <span class="cga_opparam">operations</span> any operation, any rule in the current rule file and <a href="start.html">start rules</a> of imported rule files can be used. An example is given <a href="import.html#ruleOverride">below</a>.</p>

<p>Imports can be annotated to control their attribute presentation in the inspector. See <a href="cga_annotations.html">Annotations</a>.</p>

<h2>Examples</h2>

<a name="attrPropagation"></a><h3>Import and attribute propagation</h3>

<p>This example illustrates how to import rule files, how to reference imported rules (or attributes and functions) and how attribute values are propagated.</p>

<h4>Imported rule file</h4>

<p>In the following rule file <span class="codelight">structure.cga</span> the rule <span class="codelight">Lot</span> performs an extrusion. The extrusion height is specifed by the attribute <span class="codelight">height</span>. If this rule file is used standalone, the extrusion will be of height 10. If this rule file is imported, <span class="codelight">height</span> will potentially have a different value.</p>

<pre class="codecgaborder"><font color="#009900">// structure.cga</font>

attr height = 10

Lot --> extrude(height)
</pre>

<h4>Importing rule file</h4>

<p>The following rule file <span class="codelight">main.cga</span> imports the rule file <span class="codelight">structure.cga</span>. The rule <span class="codelight">Init</span> references the rule <span class="codelight">Lot</span> of <span class="codelight">structure.cga</span> using the prefix identifier <span class="codelight">st</span>. Further, an attribute <span class="codelight">height</span> is defined which potentially overrides the same attribute in imported rule files. Because an attribute <span class="codelight">height</span> is also defined in <span class="codelight">structure.cga</span> the value is propagated and the extrusion will be of height 20.</p>

<pre class="codecgaborder"><font color="#009900">// main.cga</font>

import st : "structure.cga"

attr height = 20

Init --> st.Lot <font color="#009900"></font>
</pre>

<a name="ruleOverride"></a><h3>Extension rule override</h3>

<p>This example illustrates how <a href="extension.html">extension rules</a> can be redefined in an <span class="codelight">import</span> statement and how <a href="start.html">start rules</a> can be used in redefinitions.</p>

<h4>Simple temple model</h4>

<p>In the following rule file <span class="codelight">temple.cga</span> the start rule <span class="codelight">Temple</span> generates a simple temple model. Each column is generated by the extension rule <span class="codelight">Column</span>. The roof is generated by the extension rule <span class="codelight">Roof</span>. The height of the columns is set by the attribute <span class="codelight">columnHeight</span>. Both extension rules and attributes can be redefined in import statements in order to customize the temple model.</p>

<pre class="codecgaborder"><font color="#009900">// temple.cga</font>

attr columnHeight = 12
start Temple --> CreateColumns
                 CreateRoof
extension Column --> primitiveCube
extension Roof --> roofHip(22)

const columnWidth = columnHeight/9
CreateColumns -->
    offset(-columnWidth, border) 
    comp(f) { all :
        extrude(columnHeight)
        split(x) {
            { ~columnWidth : Column | ~2*columnWidth : NIL }* | ~columnWidth : NIL
        }
    }
CreateRoof --> t(0,columnHeight,0) Roof
</pre>

<p>The resulting model looks like this:</p>

<img src="images/import-temple.png" alt="import-temple" width="298"/>

<h4>Customized columns</h4>

<p>In the following rule files <span class="codelight">corinthianColumn.cga</span> and <span class="codelight">ionicColumn.cga</span> the rules <span class="codelight">CorinthianColumn</span> and <span class="codelight">IonicColumn</span> generate columns in a different manner as the default behavior defined by the rule <span class="codelight">Column</span> in <span class="codelight">temple.cga</span>. Both <span class="codelight">CorinthianColumn</span> and <span class="codelight">IonicColumn</span> are defined as a start rule and can therefore be used in rule overrides of import statements.</p>

<pre class="codecgaborder"><font color="#009900">// corinthianColumn.cga</font>

start CorinthianColumn --> split(y) { ~1 : Shaft | '0.1 : Base } 
	
Base --> primitiveCube
Shaft --> s('0.8, '1,'0.8) center(xz) primitiveCube
</pre>
<pre class="codecgaborder"><font color="#009900">// ionicColumn.cga</font>

start IonicColumn --> split(y) { '0.1: Base | ~1 : Shaft | '0.1: Base } 

Base --> primitiveCube
Shaft --> primitiveCylinder
</pre>

<h4>Customized temple model</h4>

<p>The following rule file <span class="codelight">myTemple.cga</span> imports the rule file <span class="codelight">temple.cga</span> using the prefix identifier <span class="codelight">CorinthianTemple</span> and the prefix identifier <span class="codelight">IonicTemple</span>. In each <span class="codelight">import</span> statement the attribute <span class="codelight">columnHeight</span> and extension rules are redefined. The redifinitions of <span class="codelight">Column</span> invoke the start rules of <span class="codelight">corinthianColumn.cga</span> and <span class="codelight">ionicColumn.cga</span> respectively. The redefinition of the <span class="codelight">Roof</span> rule sets a color and invokes the rule <span class="codelight">MyRoof</span> in the current ruleset (in the same rule file). Within the <span class="codelight">Init</span> rule the start rule of <span class="codelight">temple.cga</span> is invoked. Depending on which prefix identifier is used a different temple model is generated.</p>

<pre class="codecgaborder"><font color="#009900">// myTemple.cga</font>

import CorinthianColumn : "corinthianColumn.cga" 
import CorinthianTemple : "temple.cga" ( 
    columnHeight = 8,
    Column --> CorinthianColumn.start,  
    Roof --> color(1,0.5,0.5) MyRoof )

import IonicColumn : "ionicColumn.cga" 
import IonicTemple : "temple.cga" ( 
    columnHeight = 16,
    Column --> IonicColumn.start,  
    Roof --> color(1,0.5,0) MyRoof )

@Enum("Corinthian", "Ionic")
attr type = "Corinthian"
Init --> case type == "Corinthian" : CorinthianTemple.start   
         else                      : IonicTemple.start
MyRoof --> roofGable(22)
</pre>

<p>The resulting models look like this:</p>

<table>
<tr>	
	<td>
	<img src="images/import-corinthian-temple.png"></img><br>
	<center><span class="codelight">type == "Corinthian"</span></center>
	</td>
	<td>
	<img src="images/import-ionic-temple.png"></img><br>
	<center><span class="codelight">type == "Ionic"</span></center>
	</td>
</tr>
</table>

<p class="foot">Copyright &copy;2008-2022 Esri R&amp;D Center Zurich. All rights reserved.</p>

</div>
</body>

</html>
