<html>

<head>
    <title>fileSearch / filesSearch Functions</title>
    <link rel="stylesheet" href="../manual_style.css" type="text/css" />
</head>

<body>
<div class="content">

<!-- HEADER (use only on bookchapters) -->

<table summary="" class="header">
	<tr>
		<td align="left" class="helphead_l"><a href="../toc.html"><div class="helplink">&nbsp;</div></a></td>
		<td align="right" class="helphead_r"></td>
	</tr>
</table>

<!-- CONTENT -->

<h1>fileSearch / filesSearch functions</h1>

<h2>Syntax</h2>

<p class="code2"><span class="codelight">string</span>&nbsp&nbsp&nbspfileSearch(<span class="cga_opparam">searchQuery</span>)</p>

<p class="code2"><span class="codelight">string[]</span>&nbspfilesSearch(<span class="cga_opparam">searchQuery</span>)</p>
        
<h2>Parameters</h2>

<ul>
	<li><span class="cga_opparam">searchQuery</span> (string)<br>Search query to apply on all files in the workspace. See below for details.</li>
</ul>
      
<h2>Returns</h2>

<p>An alphabetically sorted list with all files in the workspace matching the <span class="cga_opparam">searchQuery</span>.</p>

<p><span class="code_std">fileSearch</span> returns a string list - each entry is terminated with a &quot;;&quot; (semicolon).<br><span class="code_std">filesSearch</span> returns a string array.</p>
        
<h2>Description</h2>

<p>The <span class="cga_keyword">fileSearch</span> and <span class="cga_keyword">filesSearch</span> functions list all files in the workspace which match their absolute path with the <span class="cga_opparam">searchQuery</span>. Search queries are relative to the current project (i.e. the project in which the current rule file resides) except if the <span class="cga_opparam">searchQuery</span> is based on an absolute workspace path (i.e. starts with a slash (&quot;/&quot;) or a wildcard (* or ?). Pseudocode of the matching algorithm:</p>

<pre>
result = ""
for all open projects in workspace :
   if project == current project:
	  result +=  all matching files in project, relative to assets folder
	  result +=  all matching files in project, relative to project folder
   fi
   
   result += all matching files in project, relative to workspace root
   sort result
end
</pre>

<h3>Search Queries</h3>

<p>The CityEngine features advanced search queries supporting wildcards, regular expressions and file properties such as filetype. All files in the workspace are filtered with the query and the absolute workspace path is returned. Whitespace means AND; queries with filepaths containing a space character need special treatment.
 
<h4>Wildcards</h4>

<p>The common wildcards characters '*' (asterisk character) and '?' (question mark) are supported. The asterisk substitutes for any series of characters (including no characters), and the question mark substitutes any single character.</p>
 
<h4>Regular Expressions</h4>

<p>Regular expressions allow for complex string patterns descriptions. A comprehensive introduction to regular expressions is out of scope for this manual, please refer to other sources such as <a class="normw" href="http://en.wikipedia.org/wiki/Regular_expression" target="_blank">Wikipedia</a> or the specification from the <a class="normw" href="http://www.opengroup.org/onlinepubs/007908799/xbd/re.html" target="_blank">Open Group</a>.<br>
Regular expressions start with '$'. Always put the '$' as the FIRST character if your <span class="cga_opparam">searchQuery</span> is a regular expression! Note that with regular expressions, the semantics of the wildcards "*" and "?" changes. "*" matches the preceding element zero or more times, therefore use ".*" to emulate the "match anything" behaviour.</p>

<h4>Whitespace Characters</h4>
Because whitespace means AND, searchqueries containing an actual space need to be put into single quotes.
For example
<pre class="code3">filesSearch("'facade pictures/greek style *.png'")</pre> 
Alternatively, spaces can be escaped in regexps with "\s" or "\x20":
<pre class="code3">filesSearch("$facade\\spictures/greek\\sstyle\\s.*.png")</pre> 
<em>Note the double backslashes - this is needed because the CGA compiler also interpretes the '\' character on compilation.
</em> 
<h4>File Properties</h4>

<p>Following file properties can be querried:
<ul>
	<li><strong>Name</strong>: Filename</li>
	<li><strong>Ext</strong>: File extension</li>
	<li><strong>Project</strong>: Project name</li>
	<li><strong>Path</strong>: Filepath</li>
</ul>
</p>  
            
<h2>Related</h2>
<ul>
	<li><a href="func_splitString.html"><span class="code_std">splitString</span></a> function</li>
</ul>

<h2>Examples</h2>

In the following examples, we use a basic workspace with two projects and a few files. The examples are in rule.cga, i.e. MyProject is the current project.

<center>
<img src="images/fileSearchWorkspace.png"></img>
</center>

<h3>Wildcards</h3>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("*.png")</pre></td>
	<td><pre class="code3">
[/MyProject/assets/textures/1.png,
 /MyProject/assets/textures/2.png,
 /MyProject/assets/textures/4.png,
 /MyProject/assets/tower.png,
 /OtherProject/assets/glass.png]</pre></td>
</tr>
</table>

<i>Because the searchQuery starts with an asterisk, all projects are included in the search.</i>

<br><br>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("?.png")</pre></td>
	<td><pre class="code3">[]</pre></td>
</tr>
</table>

<i>There is no png file with a 1-character-name in the root directory or the asset directory of the current project.</i>

<br><br>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("*/?.png")</pre></td>
	<td><pre class="code3">
[/MyProject/assets/textures/1.png;
 /MyProject/assets/textures/2.png,
 /MyProject/assets/textures/4.png]</pre></td>
</tr>
</table>

<i>Because of the leading asterisk, all folders are searched for a png file with a 1-character-name.</i>

<br><br>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("textures/*")</pre></td>
	<td><pre class="code3">
[/MyProject/assets/textures/1.png,
 /MyProject/assets/textures/2.png,
 /MyProject/assets/textures/4.png]</pre></td>
</tr>
</table>

<i>All files in the "textures" subfolder of the asset folder in the current project match.</i>

<br><br>

<h3>Regular Expression to select specific characters</h3>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("$[12].png")</pre></td>
	<td><pre class="code3">[]</pre></td>
</tr>
</table>

<i>There is no png file with name "1" or "2" in the root directory or the asset directory of the current project.</i>

<br><br>

<h3>Regular Expression to select specific characters, part 2</h3>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("$textures/[12].png")</pre></td>
	<td><pre class="code3">
[/MyProject/assets/textures/1.png,
 /MyProject/assets/textures/2.png]</pre></td>
</tr>
</table>

<i>All png files with name "1" or "2" in the "textures" subfolder of the asset folder in the current project match.</i>

<br><br>

<h3>Regular Expression + Wildcard</h3>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("$.*/[12].png")</pre></td>
	<td><pre class="code3">
[/MyProject/assets/textures/1.png,
 /MyProject/assets/textures/2.png]</pre></td>
</tr>
</table>

<i>All png files with name "1" or "2" match. Note the period before the asterisk!</i>

<br><br>

<h3>Regular Expression to select a range of characters</h3>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("$textures/[2-5].png")</pre></td>
	<td><pre class="code3">
[/MyProject/assets/textures/2.png,
 /MyProject/assets/textures/4.png]</pre></td>
</tr>
</table>

<i>All png files with name "2", "3, "4" or "5" in the "textures" subfolder of the asset folder in the current project match.</i>

<br><br>

<h3>Regular Expression + OR</h3>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("$textures/[12].png|.*.obj")</pre></td>
	<td><pre class="code3">
[/MyProject/assets/textures/1.png,
 /MyProject/assets/textures/2.png,
 /MyProject/assets/tower.obj,
 /OtherProject/assets/brick.obj]</pre></td>
</tr>
</table>

<i>All png files with name "1" or "2" in the "textures" subfolder of the asset folder in the current project and all obj files in the workspace match.</i>

<br><br>

<h3>File Properties</h3>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("Name=1.png")</pre></td>
	<td><pre class="code3">
[/MyProject/assets/textures/1.png]</pre></td>
</tr>
</table>

<i>Only one file matches the name excatly.</i>

<br><br>

<h3>File Properties, AND</h3>

<table class="twocol" cellspacing=5>
<tr>
	<td width="50%"><pre class="code3">filesSearch("Project=OtherProject Ext=obj")</pre></td>
	<td><pre class="code3">
[/OtherProject/assets/brick.obj]</pre></td>
</tr>
</table>

<i>Using whitespace, two or more queries can be combined. Here, a file must match both the project name and the file extension.</i>

<!-- FOOTER -->
<p class="foot">Copyright &copy;2008-2025 Esri R&amp;D Center Zurich. All rights reserved.</p>				  

<!-- END CENTERED CONTENT -->

</div>
</body>
</html>