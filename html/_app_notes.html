<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ArcGIS Procedural Runtime: Application Notes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="esri_prt_55px.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ArcGIS Procedural Runtime
   &#160;<span id="projectnumber">3.2.10211</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Application Notes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Application Note 1: Instancing</h2>
<p>In general, the term "instancing" refers to the re-use of data - usually geometry - by using references instead of copies. During model generation in PRT instancing can happen in two ways:</p><ol type="1">
<li>Asset Instancing: if an asset is only inserted (<a href="cgaref/cgareference/op_i.html">insert()</a>) and not modified by CGA (e.g. <a href="cgaref/cgareference/attr_material.html">material properties</a>) then the corresponding <a class="el" href="classprtx_1_1_geometry.html">prtx::Geometry</a> object will carry its original URI through into the encoder and can be re-used accordingly by the encoder.</li>
<li>Geometry/Material Instancing: if the geometry of an asset is used multiple times and its materials are modified in the rules then the encoder author can make use of the EncodePreparator instance() flag. If this flag is set to true, the EncodePreparator will re-use the geometry objects (same reference/pointer) and return a separate list of finalized materials (<a class="el" href="classprtx_1_1_encode_preparator_1_1_finalized_instance.html#a31e049c0382d0708b0889c8ad479c78c">prtx::EncodePreparator::FinalizedInstance::getMaterials()</a>). If the intended target format supports this type of instancing the encoder can directly translate this one-geometry-to-multiple-materials mapping into the target format.</li>
</ol>
<h2>Application Note 2: Exporting ordered meta data per initial shape</h2>
<p>All <a href="esri_prt_codecs.html">built-in encoders</a> of the CE SDK which support writing initial shape attributes understand the reserved initial shape attribute key "/enc/metaData/". If any attributes are prefixed with "/enc/metaData" the encoder will attempt to output them accordingly.</p>
<p>Here is an example how to get the attributes "myItem1, myItem2, myItem3" to output in the order "myItem1, myItem3, myItem2": </p><pre class="fragment">prt::AttributeMapBuilder* builder = prt::AttributeMapBuilder::create();
builder-&gt;setInt(L"/enc/metaData/myItem1", 10);
builder-&gt;setInt(L"/enc/metaData/myItem2", 20);
builder-&gt;setInt(L"/enc/metaData/myItem3", 30);
builder-&gt;setInt(L"myItemForCGA", 99);

const prt::AttributeMap* attrMap = builder-&gt;createAttributeMap();
builder-&gt;destroy();

prt::InitialShapeBuilder* isBuilder = prt::InitialShapeBuilder::create();
isBuilder-&gt;setAttributes(..., attrMap, ...);
const prt::InitialShape* initialShape = isBuilder-&gt;createInitialShapeAndReset();
isBuilder-&gt;destroy();

prt::generate(...); // -&gt; encoders will emit "myItem1, myItem3, myItem2"

initialShape-&gt;destroy();
attrMap-&gt;destroy();
</pre><dl class="section see"><dt>See also</dt><dd><a class="el" href="classprt_1_1_initial_shape_builder.html#a54112771964d72bdad2ce9d6a28fe20a">prt::InitialShapeBuilder::setAttributes</a></dd></dl>
<h2>Application Note 3: Requirements for CityEngine custom exporters</h2>
<p>A PRT encoder must meet a few requirements to be successfully loaded by CityEngine as a custom exporter:</p><ol type="1">
<li>CityEngine needs to have version 2014.0 or later</li>
<li>The encoder factory needs to specify id, name, description, type and file extension (see below for an example).</li>
<li>To make an encoder option appear in the CityEngine UI, the following annotations are mandatory: LABEL, ORDER, GROUP and DESCRIPTION</li>
<li>The boolean option "errorFallback" needs to be present. If true, the encoder is expected to encode the initial shape geometry. Usually, this option should be hidden (see <a class="el" href="classprtx_1_1_encode_options_annotator.html#ab1fbd90176dcfc6f2bbab116634caa59">prtx::EncodeOptionsAnnotator::flagAsHidden()</a>).</li>
</ol>
<p>Here is an example how to setup an encoder info object inside an encoder factory (the full sources are available in the "stlenc" example): </p><pre class="fragment">prtx::EncoderInfoBuilder encoderInfoBuilder;
encoderInfoBuilder.setID(...);
encoderInfoBuilder.setName(...);
encoderInfoBuilder.setDescription(...);
encoderInfoBuilder.setType(prt::CT_GEOMETRY);
encoderInfoBuilder.setExtension(L".ext");
</pre><dl class="section see"><dt>See also</dt><dd><a class="el" href="classprtx_1_1_encoder_info_builder.html">prtx::EncoderInfoBuilder</a></dd></dl>
<h2>Application Note 4: How-To create a FILE URI from a file system path</h2>
<p>All URIs in PRT follow the standard RFC3986: <a href="http://www.ietf.org/rfc/rfc3986.txt">http://www.ietf.org/rfc/rfc3986.txt</a> In practice this means:</p><ol type="1">
<li>the URI string must be UTF-8 encoded</li>
<li>all characters which are not allowed according to section 2 of RFC3986 must be percent-encoded (see prtx::URI::percentEncode).</li>
<li>"file" URIs must contain an absolute path, i.e. start with a slash after "file:". This is also required on windows, i.e. "file:/C:/path/".</li>
</ol>
<p>Here is an example how to create such an URI from a file system path: </p><pre class="fragment">// linux/osx example (assuming UTF8 for native strings)
std::string fsp = "/home/johndoe/my/path/hello.txt";
std::string uri = prtx::URI::SCHEME_FILE + ":" + fsp; // results in 'file:/home/johndoe/my/path/hello.txt'
uri = prtx::URI::percentEncode(uri);
std::wstring wuri(uri.size(), L' ');
std::copy(uri.begin(), uri.end(), wuri.begin());
// now use wuri.c_str() for prt API calls...

// windows example (assuming Latin1 string encoding)
std::string fsp = "C:/some/path/file.txt"; // note: windows paths must be converted to forward slashes
std::string u8fsp = boost::locale::conv::to_utf&lt;char&gt;(fsp, "Latin1");
std::string uri = prtx::URI::SCHEME_FILE + ":/" + u8fsp; // note the slash before the drive letter
uri = prtx::URI::percentEncode(uri);
std::wstring wuri(uri.size(), L' ');
std::copy(uri.begin(), uri.end(), wuri.begin());
// now use wuri.c_str() for prt API calls...
</pre> </div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Jun 19 2024 15:18:39 for ArcGIS Procedural Runtime by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
