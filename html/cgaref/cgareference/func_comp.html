<html>

<head>
	<title>comp Function</title>
	<link rel="stylesheet" href="../manual_style.css" type="text/css" />
</head>

<body>
<div class="content">

<table summary="" class="header">
	<tr>
		<td align="left" class="helphead_l"><a href="../toc.html"><div class="helplink">&nbsp;</div></a></td>
		<td align="right" class="helphead_r"></td>
	</tr>
</table>

<h1>comp function</h1>

<h2>Syntax</h2>

<p class="code2"><span class="codelight">float[]</span>&nbsp&nbspcomp(<span class="cga_opparam">component</span>) { <span class="cga_opparam">selector</span> <span class="cga_opparam">operator</span> <span class="cga_opparam">expression</span> | <span class="cga_opparam">selector</span> <span class="cga_opparam">operator</span> <span class="cga_opparam">expression</span> ... }</p>
<p class="code2"><span class="codelight">string[]</span>&nbspcomp(<span class="cga_opparam">component</span>) { <span class="cga_opparam">selector</span> <span class="cga_opparam">operator</span> <span class="cga_opparam">expression</span> | <span class="cga_opparam">selector</span> <span class="cga_opparam">operator</span> <span class="cga_opparam">expression</span> ... }</p>
<p class="code2"><span class="codelight">bool[]</span>&nbsp&nbsp&nbspcomp(<span class="cga_opparam">component</span>) { <span class="cga_opparam">selector</span> <span class="cga_opparam">operator</span> <span class="cga_opparam">expression</span> | <span class="cga_opparam">selector</span> <span class="cga_opparam">operator</span> <span class="cga_opparam">expression</span> ... }</p>

<h2>Parameters</h2>

<ul>
	<li><span class="cga_opparam">component, selector, operator</span><br>These parameters are the same as for the  <a class="cga_op" href="op_comp.html#params">comp</a> operation.</li>
	<li><span class="cga_opparam">expression</span> (float, string, bool)<br>An expression evaluated per component. All expressions must be of the same type.</li>
</ul>

<h2>Returns</h2>

<p>An array that contains the returned values of <span class="cga_opparam">expression</span> for each component.</p> 

<h2>Description</h2>

<p>Very much like the <a class="cga_op" href="op_comp.html">comp</a> operation the <span class="codelight">comp</span> function divides a shape into topological components (wrt. <span class="cga_opparam">component</span>, <span class="cga_opparam">selector</span>, <span class="cga_opparam">operator</span>) which result in new component shapes. But in contrast to the operation the function does not process the selected components by a sequence of shape operations. Instead a functional <span class="cga_opparam">expression</span> is evaluated on each selected component shape. The respective return values are organized in an ordered array which is returned as the result of the <span class="codelight">comp</span> function. Refer to the documentation of the <a class="cga_op" href="op_comp.html">comp</a> operation for details on available <span class="cga_opparam">component</span> selectors, <span class="cga_opparam">selector</span>s and <span class="cga_opparam">operator</span>s.</p>

<p>The returned array has a number of properties:
<ul>
	<li>Its size is equal to the number of faces, edges, etc. for <span class="cga_opparam">component</span> set to <span class="codelight">f</span>, <span class="codelight">e</span>, etc. respectively.</li>
	<li>For example, for <span class="cga_opparam">component</span> set to <span class="codelight">f</span>, the array contains the returned value of <span class="cga_opparam">expression</span> for each face: the value for face index 0 at position 0, for face index 1 at position 1, and so on.</li>
	<li>Evaluated <span class="cga_opparam">expressions</span>s of combined component shapes (<span class="cga_opparam">operator</span> <span class="codelight">=</span>) are copied and inserted for each respective topological entity at the relevant index positions.</li>
	<li>Topological entities which are not selected by a <span class="cga_opparam">selector</span> are inserted with a default value (<span class="codelight">0</span>, <span class="codelight">""</span>, <span class="codelight">false</span> respectively) at the relevant index positions.
</ul>
</p>

<p class="notes">The <span class="codelight">comp</span> function allows you to gather information about the current shape and its components without changing the current shape or adding successor shapes to the shape tree.</p>

<p class="notes">The size of the returned array is limited. It can be configured in the <a href="https://doc.arcgis.com/en/cityengine/latest/help/get-started-preferences-prt.htm" target="_blank">Procedural Runtime preferences</a> (Default: 100000).</p>

<h2>Related</h2>

<ul>
	<li><a href="op_comp.html">comp operation</a></li>
	<li><a href="op_setback.html">setback operation</a></li>
	<li><a href="func_size.html"><span class="code_std">size</span></a> function</li>
	<li><a href="arrayTypes.html">Array types operators</a></li>
	<li><a href="func_findFirst.html"><span class="code_std">findFirst</span></a> function</li>
	<li><a href="func_sum.html"><span class="code_std">sum</span></a> function</li>
	<li><a href="attr_comp.html">comp attribute</a></li>
	<li><a href="func_edgeAttr.html">Edge attribute functions</a></li>
</ul>

<h2>Explanatory examples</h2>

<h3>Vertices | Comp shape attributes</h3>

<table summary="" class="twocol">
<tr>
	<td class="twocol_l"><br><img src="images/func-comp-vertices.png" width="298" alt="func-comp-vertices"/></td>
	<td><pre class="code3">
const array = comp(v) { all : comp.index }

Lot --> print(array)

(6)[<font color="red">0</font>, <font color="red">1</font>, <font color="red">2</font>, <font color="red">3</font>, <font color="red">4</font>, <font color="red">5</font>]
	</pre>
	<em>A shape is split into <span class="codelight">all</span> of its 6 vertices. Each vertex component is asked for its <a href="attr_comp.html">component index</a>. These values are then organized in an array in vertex index order.</em>
	</td>
</tr>
</table>

<h3>Edges | Scope shape attributes</h3>

<table summary="" class="twocol">
<tr>
	<td class="twocol_l"><br><img src="images/func-comp-edges.png" width="298" alt="func-comp-edges"/></td>
	<td><pre class="code3">
edgeLength = scope.sx
	
const array = comp(e) { border : edgeLength }

(7)[<font color="red">7</font>,<font color="red">15</font>,0,<font color="red">17</font>,<font color="red">15</font>,<font color="red">10</font>,<font color="red">16</font>]
	</pre>
	<em>In this example the shape with 7 edges is split into its 6 <span class="codelight">border</span> edges. Each edge component is asked for its length via its <a href="attr_scope.html">scope attribute</a>. Edge 2 is not selected but inserted in the array with a default value <span class="codelight">0</span>.</em>
	</td>
</tr>
</table>

<h3>Face edges | Combine shape operator</h3>

<table summary="" class="twocol">
<tr>
	<td class="twocol_l"><br><img src="images/func-comp-faceedges.png" width="298" alt="func-comp-faceedges"/></td>
	<td><pre class="code3">
const array = comp(fe) { front : comp.sel + comp.index |
                         back  = str(comp.index)       }
		   
(8)[<font color="red">front0</font>,,<font color="blue">0</font>,,,<font color="blue">0</font>,,<font color="red">front1</font>]
	</pre>
	<em>The shape with 8 face edges is split into its 2 <span class="codelight">front</span> face edges and into a combined shape consisting of 2 <span class="codelight">back</span> face edges (<span class="cga_opparam">operator</span> <span class="codelight">=</span>). For each <span class="codelight">front</span> edge a string is constituted using <a href="attr_comp.html">comp shape attributes</a>. The second string expression is evaluated only once but the return value is inserted at all respective <span class="codelight">back</span> edge indices. The remaining edges are not selected but inserted with a default value (empty string <span class="codelight">""</span>).</em>
	</td>
</tr>
</table>

<h3>Faces | Occlusion query</h3>

<table summary="" class="twocol">
<tr>
	<td class="twocol_l"><br><img src="images/func-comp-faces.png" width="298" alt="func-comp-faces"/></td>
	<td><pre class="code3">
const array = comp(f) { side = touches }
		   
(6)[false,<font color="red">true</font>,<font color="red">true</font>,<font color="red">true</font>,<font color="red">true</font>,false]
	</pre>
	<em>The shape with 6 faces is split into one shape consisting of 4 <span class="codelight">side</span> faces. An <a href="cga_context.html">occlusion</a> query is evaluated once and the result is inserted into the array for all <span class="codelight">side</span> faces. The remaining faces are not selected but inserted with a default value (<span class="codelight">false</span>).</em>
	</td>
</tr>
</table>

<br>

<p>See for example the <a class="cga_op" href="op_setback.html#examples">setback</a> operation for applications.</p>

<p class="foot">Copyright &copy;2008-2021 Esri R&amp;D Center Zurich. All rights reserved.</p>				  

</div>
</body>
</html>